# 游戏规则审核报告

**审核日期**: 2026-02-08
**PRD版本**: v0.9
**审核范围**: GAME_LOGIC_PRD.md, GAME_DESIGN.md, UI_DESIGN.md, PROJECT_PLAN.md, ui-prototype/index.html
**审核员**: 独立规则审核员（第三方视角）

---

## 审核摘要

| 类别 | 问题数 | 最高严重度 |
|------|--------|-----------|
| 文档一致性 | 6 | **严重** |
| 平衡性 | 3 | 中等 |
| 边界情况 | 3 | **严重** |
| 博弈空间 | 1 | 轻微 |
| 可实现性 | 2 | 中等 |
| **总计** | **15** | |

**总体评价**: PRD v0.9 核心游戏逻辑设计扎实，博弈机制有深度。但存在 **3个严重问题** 必须在开发前修复：反震时序矛盾、GAME_DESIGN.md严重过期、原型数据错误。另有多个中等问题建议处理。

---

## 发现的问题

### 严重问题 (3个)

---

### [严重-1] GAME_DESIGN.md 严重过期，与 PRD v0.9 大面积冲突

**位置**: `docs/GAME_DESIGN.md` 全文
**描述**: GAME_DESIGN.md 停留在约 v0.3 版本水平，与当前 PRD v0.9 存在大量矛盾：

| 项目 | GAME_DESIGN.md | PRD v0.9 (正确) |
|------|----------------|-----------------|
| 弓箭手HP | 250 | **270** |
| 顶盾效果 | "本回合韧性值增至8" | **"+2韧性，持续3回合"** |
| 重锤条件 | "目标未逃跑则×1.5" | **"目标防御则×1.5"** |
| 装甲战士技能数 | 3个 | **5个**（缺盾击、反震） |
| 弓箭手技能数 | 3个 | **7个**（缺回马枪、匕首突刺、彩虹穿云、漫天花雨） |
| 装甲战士被动 | 无 | **钢铁意志（+5怒气/回合）** |
| 弓箭手被动 | 无 | **游击战术 + 精确瞄准** |
| 技能类型系统 | 无 | **近战/远程/魔法/辅助** |
| 真实伤害机制 | 无 | **漫天花雨80真伤** |

**影响**: 开发者可能引用错误文档，导致实现与PRD不一致
**建议**:
- **方案A（推荐）**: 删除 GAME_DESIGN.md，PRD 作为唯一权威文档
- **方案B**: 将 GAME_DESIGN.md 降级为"设计概览"，顶部加大字警告"详细规则以 GAME_LOGIC_PRD.md 为准"，并同步更新

---

### [严重-2] 反震时序逻辑矛盾

**位置**: PRD 第六章 6.2 反震规则 + UI_DESIGN.md 第三章 TURN_START 状态
**描述**: PRD 描述反震"无视敏捷顺序，**回合开始时**立刻生效"。UI设计文档在 TURN_START 状态中写道"反震立即生效标记（若装甲战士本回合使用反震）"。

**问题**: 这存在时序矛盾——TURN_START 发生在 ACTION_SELECT **之前**，此时玩家尚未选择动作，系统不可能知道装甲战士是否选择了反震。

**可能的正确意图**:
- A. 反震在 RESOLVE 阶段最先结算（无视AGI顺序，视为AGI=∞），但仍在动作选择之后
- B. 反震是"预设"型技能——上一回合预选，本回合TURN_START自动生效

**影响**: 开发时无法确定反震的触发时机，可能导致战斗逻辑错误
**建议**: 明确改为："在动作结算阶段（RESOLVE），反震**最先结算**，无视敏捷排序。装甲战士选择反震后，在所有其他角色行动之前，反震状态立即生效。"

---

### [严重-3] 原型中装甲战士大招名称错误

**位置**: `ui-prototype/index.html` 第1017行
**描述**: 装甲战士角色卡描述写"大招：**破甲重击**"，但 PRD 中不存在此技能。装甲战士的RAGE技能为**顶盾**（60怒气）和**反震**（60怒气），均为辅助型，非伤害型"大招"。
**影响**: 产品经理审核时可能基于错误信息做决策；开发者可能尝试实现不存在的技能
**建议**: 改为"怒气技能：**顶盾** + **反震**" 或 "核心：**反震反弹**，近战者噩梦"

---

### 中等问题 (7个)

---

### [中等-1] UI_DESIGN.md 布局方案与原型不一致

**位置**: `docs/UI_DESIGN.md` 第二章 vs `ui-prototype/index.html`
**描述**:
- UI设计文档定义 **弧形排列**（所有角色沿弧线均匀分布，无阵营区分），并提供了详细的弧线坐标公式
- 原型实际使用 **三角形布局**（玩家底部居中面朝北，对手对称分布在左上和右上面朝南）
- 这是两种完全不同的设计思路：弧形强调"全员混战平等"，三角形暗示"玩家vs对手"

**影响**: 开发时不确定该按哪个实现
**建议**: 统一为一种方案。如果选择三角形布局，需要定义 2人、4-8人的布局变体。如果选择弧形，需要更新原型。

---

### [中等-2] UI_DESIGN.md 配色方案与原型不一致

**位置**: `docs/UI_DESIGN.md` 第四章 vs `ui-prototype/index.html` CSS变量
**描述**:

| 元素 | UI_DESIGN.md | 原型实际 |
|------|-------------|----------|
| 主背景 | `#1A1A2E`（深靛蓝） | `#08060E`（近黑暖色） |
| 副背景 | `#16213E`（暗海军蓝） | `#0E0C18`（深紫黑） |
| 面板色 | `#0F3460`（深宝蓝） | `rgba(14,10,22,0.92)` |
| 高亮色 | `#E94560`（胭脂红） | `#C8A050`（暖金色） |
| 设计基调 | 冷色蓝系 | **暖色金棕系** |

**影响**: 两套完全不同的视觉风格，文档无法指导开发
**建议**: 以原型的暖金配色为准（更符合"中式仙侠"定位），更新 UI_DESIGN.md 配色章节

---

### [中等-3] 原型中"防御"效果描述错误

**位置**: `ui-prototype/index.html` 第1153行
**描述**: 防御按钮显示"韧性+50%"，但 PRD 实际公式为 `韧性 × (100% + 10% × 初始韧性值)`：

| 角色 | 原型显示 | PRD实际 |
|------|---------|---------|
| 骑士(DEF=2) | +50% | **+20%** (2→2.4) |
| 装甲战士(DEF=3) | +50% | **+30%** (3→3.9) |
| 弓箭手(DEF=1.5) | +50% | **+15%** (1.5→1.725) |

**影响**: 误导产品经理对防御机制的理解
**建议**: 修改为角色实际值，或统一显示"韧性提升"不带具体百分比

---

### [中等-4] 漫天花雨在多人战中伤害过度缩放

**位置**: PRD 第六章 6.3 弓箭手技能
**描述**: 漫天花雨对**全体敌人**造成80真实伤害，在不同人数下总伤害差异巨大：

| 人数 | 敌人数 | 总伤害 | 相当于 |
|------|--------|--------|--------|
| 2人 | 1 | 80 | 弓箭手总HP的30% |
| 3人 | 2 | 160 | — |
| 5人 | 4 | 320 | 几乎等于骑士全部HP |
| 8人 | 7 | **560** | 超过装甲战士HP×1.6 |

在8人对战中，一个80怒气的漫天花雨就能造成560总伤害，这远超其他任何技能。

**影响**: 8人对战中弓箭手可能成为压倒性优势角色
**建议**:
- 保持当前设计（接受弓箭手在大规模战中更强，作为角色特色）
- 或添加上限：最多影响4-5个目标
- 建议在开发阶段进行多人数平衡测试再决定

---

### [中等-5] 0存活者场景未定义

**位置**: PRD 第二章 2.1 游戏流程
**描述**: PRD 说"最后存活者获胜"，但未定义所有角色同时死亡（0存活者）的情况。虽然当前结算机制（按AGI逐个结算）使得严格的"同时死亡"几乎不可能，但以下场景可能导致：
- 角色A使用冲锋(消耗10HP)攻击角色B，B死亡。但A也因HP消耗而死亡（A只剩≤10HP）
- 这种情况下，A在自己的行动中"杀死"了B，但A的HP也因消耗降为≤0

**影响**: 结算画面无法显示获胜者
**建议**: 明确规则："HP消耗在攻击结算后扣除。若攻击者因HP消耗死亡，其攻击仍然有效，最后存活的一方（可能是0回合活着的其他角色）获胜。若确实0存活，判定为**平局**。"

---

### [中等-6] AI行为规则过于简略

**位置**: PRD 第八章
**描述**: AI规则仅有3条模糊原则（"优先使用技能"、"随机混淆"、"资源管理"），无法转化为具体代码。虽然 `AI_STRATEGY_DESIGN.md` 可能有更详细的设计，但PRD应该至少包含：
- AI目标选择权重（攻击最低HP？最大威胁？随机？）
- AI防御/逃跑触发条件（HP低于多少时倾向防御？）
- AI怒气技能使用时机
- 各难度级别的区分

**影响**: 开发者需要额外设计AI逻辑，可能延误进度
**建议**: 在PRD中增加AI决策伪代码，或明确指向 AI_STRATEGY_DESIGN.md 作为AI实现的权威文档

---

### [中等-7] 原型缺少关键交互状态

**位置**: `ui-prototype/index.html` 战斗画面
**描述**: 原型仅展示静态状态，缺少以下关键交互状态的展示：

| 缺失状态 | 重要性 | 说明 |
|----------|--------|------|
| 目标选择 | 高 | 选技能后需点击敌人选目标，是核心交互 |
| AI思考中 | 中 | "AI思考中..."覆盖层 |
| 动作结算动画 | 中 | 逐个角色结算的动画序列 |
| 长虹贯日多目标 | 高 | 选2个不同目标的特殊UI流程 |
| AUTO/速度按钮 | 低 | UI_DESIGN.md定义了但原型未实现 |

**影响**: 产品经理无法评审最重要的交互环节
**建议**: 至少补充"目标选择"和"长虹贯日多目标选择"两个状态的展示

---

### 轻微问题 (5个)

---

### [轻微-1] 防御对骑士和弓箭手价值过低

**位置**: PRD 第四章 4.3 防御规则
**描述**: 骑士防御仅从DEF 2提升到2.4（伤害减免从80%到76%），实际减少不到3点伤害。考虑到：
- 损失一个攻击回合
- 被马踏飞燕/重锤克制（伤害×1.5）

骑士和弓箭手几乎没有理由选择防御。

**分析**: 防御的核心价值不在于减伤数值，而在于**博弈层面**——对手猜你会防御而使用了反防御技能，但你实际进攻了，这就是博弈收益。作为心理博弈选项，其存在是合理的。
**建议**: 当前设计可接受。但如果测试中发现防御使用率极低，可考虑增强公式。

---

### [轻微-2] 冲锋技能在骑士和装甲战士间重复

**位置**: PRD 第六章 6.1 骑士 + 6.2 装甲战士
**描述**: 两个角色拥有完全相同的"冲锋"技能（10HP消耗，75伤害，目标逃跑归0）。
**影响**: 无功能问题，但减少了角色差异化
**建议**: 可接受。从设计角度，这是"通用重骑兵技能"的合理共享。

---

### [轻微-3] 长虹贯日在大规模战中效率偏低

**位置**: PRD 第六章 6.3 弓箭手技能
**描述**: 最多攻击2目标。在8人战中只能打2/7个敌人，相比漫天花雨（打全体），性价比显著下降。
**影响**: 弓箭手在大规模战中可能完全放弃此技能
**建议**: 当前可接受，弓箭手有其他技能选择。如果需要优化，可考虑"目标数=min(2+人数/4, 敌人数)"

---

### [轻微-4] 原型角色精灵方向与面朝逻辑

**位置**: `ui-prototype/index.html` 战斗画面角色精灵
**描述**:
- 骑士（玩家，底部居中）使用 `north.png`（面朝北）✅ 正确
- 装甲战士和弓箭手（顶部）使用 `south.png`（面朝南）✅ 正确
- 但UI_DESIGN.md原方案说"所有角色默认面朝南（S方向帧）"——弧形布局时所有人朝同一方向合理，但三角布局需要不同朝向

**影响**: 仅当选择弧形布局时存在矛盾
**建议**: 跟随原型方案（对面角色面朝对方），更新UI_DESIGN.md

---

### [轻微-5] 项目计划中PixiJS工具状态写"待安装"但已完成

**位置**: `docs/PROJECT_PLAN.md` 工具清单
**描述**: PixiJS 状态标记为"待安装"，但 Day 6 已经完成了 PixiJS + Vite + TypeScript 项目初始化。
**建议**: 更新为"✅ 已安装 (v8.16)"

---

## 模拟测试结果

### 测试1: 反震+冲锋 交互

**输入**: 骑士(HP 15) 使用冲锋 → 装甲战士(已开反震)
**过程**:
1. 骑士消耗 10 HP → 剩余 5 HP
2. 冲锋基础伤害 75 × (10-3)/10 = 52.5
3. 反震触发：装甲战士受 52.5×25% = 13.13，反弹 52.5×75% = 39.38
4. 骑士受到 39.38 反弹 → HP: 5 - 39.38 = -34.38 → **骑士死亡**
**结论**: 骑士因HP消耗+反弹双重损失而死亡。规则清晰，结算正确 ✅

### 测试2: 漫天花雨 + 逃跑交互

**输入**: 弓箭手使用漫天花雨，骑士已成功逃跑
**过程**:
1. 漫天花雨 = 真实伤害
2. 真实伤害无视逃跑，100%命中
3. 骑士受到 80 固定伤害
**结论**: 正确，真实伤害规则一致 ✅

### 测试3: 精确瞄准 + 游击战术 + 匕首突刺（近战）

**输入**: 弓箭手(游击状态AGI 8) 使用匕首突刺(近战) → 装甲战士(AGI 4)
**过程**:
1. 匕首突刺 = 近战类型
2. 不触发游击战术（近战不是远程技能）→ 下回合AGI恢复6
3. 基础伤害 35 × (10-3)/10 = 24.5
4. 精确瞄准: 5 × (8-4) = 20
5. 最终伤害: 24.5 + 20 = **44.5**
6. 若装甲战士开了反震：反震触发（匕首突刺是近战）！
   - 装甲战士受 44.5×25% = 11.13
   - 弓箭手受 44.5×75% = **33.38** 反弹
**结论**: 弓箭手使用近战技能打反震装甲战士会自损，设计合理 ✅

### 测试4: 0存活者场景

**输入**: 骑士(HP 8) 使用冲锋 → 弓箭手(HP 40)，AGI相同（均为7，马鞭后）
**过程**:
1. 随机决定顺序，假设骑士先行动
2. 骑士消耗 10 HP → HP: 8-10 = **-2 → 骑士先死亡？**
3. 问题：HP消耗是在攻击前还是攻击后？PRD未明确

**结论**: HP消耗时机不明确 ⚠️ 需要补充规则："技能HP消耗在技能**发动时**立即扣除，然后执行攻击效果"

---

## 改进建议优先级

### 必须修复（开发前）

1. **[严重-2] 澄清反震时序** — 改为"RESOLVE阶段最先结算"
2. **[严重-1] 处理GAME_DESIGN.md** — 删除或加警告+降级
3. **[严重-3] 修复原型"破甲重击"错误** — 改为正确技能名

### 建议修复（开发中）

4. **[中等-5] 定义0存活者规则** — 添加平局判定
5. **[中等-3] 修复原型防御百分比** — 改为实际值
6. **[中等-1/2] 统一布局和配色方案** — 以原型为准更新UI_DESIGN.md
7. **[中等-6] 补充AI规则或指向AI设计文档**
8. **模拟测试4** HP消耗时机明确化

### 长期优化（测试阶段）

9. **[中等-4] 漫天花雨多人缩放** — 多人数平衡测试
10. **[轻微-1] 防御使用率观察** — 若过低则调整公式
11. **[轻微-3] 长虹贯日大规模效率** — 考虑动态目标数

---

## 审核结论

- [ ] 通过，可以进入开发
- [x] **有条件通过，需修复3个严重问题后可进入开发**
- [ ] 不通过，存在重大设计缺陷

**核心判断**: PRD v0.9 的游戏机制设计质量高，博弈深度良好。技能条件互克系统形成了有意义的猜拳博弈。3个严重问题均为**文档/描述层面**的问题，不涉及核心机制重设计，修复成本低。修复后可直接进入 M2 开发阶段。

---

*审核完成 — 2026-02-08*
